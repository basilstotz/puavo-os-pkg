#!/bin/sh

set -eu

command=$1
shift

debfiles='
  smart-activation_1.1.2066.1-1_i386.deb
  smart-common_10.3.2171.1-1_i386.deb
  smart-gallerysetup_1.3.6235.1-1_i386.deb
  smart-hwr_11.3.2121.1-1_i386.deb
  smart-languagesetup_2.2.2060.4-1_i386.deb
  smart-notebook_11.0.7511.0-1_i386.deb
  smart-product-drivers_11.3.2121.1-1_i386.deb
'

smart_technologies_dir='/opt/SMART Technologies'

smartboard_links='
  /usr/share/icons/hicolor/128x128/apps/SMART_Board_Software.png
  /usr/share/icons/hicolor/128x128/apps/SMART_ControlPanel.png
  /usr/share/icons/hicolor/128x128/apps/SMART_Essentials_For_Educators.png
  /usr/share/icons/hicolor/128x128/apps/SMART_GallerySetup.png
  /usr/share/icons/hicolor/128x128/apps/SMART_Keyboard.png
  /usr/share/icons/hicolor/128x128/apps/SMART_LanguageChooser.png
  /usr/share/icons/hicolor/128x128/apps/SMART_Magnifier.png
  /usr/share/icons/hicolor/128x128/apps/SMART_Notebook.png
  /usr/share/icons/hicolor/128x128/apps/SMART_Orient.png
  /usr/share/icons/hicolor/128x128/apps/SMART_Pointer.png
  /usr/share/icons/hicolor/128x128/apps/SMART_ProductUpdate.png
  /usr/share/icons/hicolor/128x128/apps/SMART_ScreenCapture.png
  /usr/share/icons/hicolor/128x128/apps/SMART_ScreenShade.png
  /usr/share/icons/hicolor/128x128/apps/SMART_Spotlight.png
  /usr/share/icons/hicolor/128x128/apps/SMART_Tools.png
  /usr/share/icons/hicolor/128x128/mimetypes/application-x-smarttech-galleryitem.png
  /usr/share/icons/hicolor/128x128/mimetypes/application-x-smarttech-gallery.png
  /usr/share/icons/hicolor/128x128/mimetypes/application-x-smarttech-notebook.png
  /usr/share/icons/hicolor/128x128/mimetypes/gnome-mime-application-x-smarttech-galleryitem.png
  /usr/share/icons/hicolor/128x128/mimetypes/gnome-mime-application-x-smarttech-gallery.png
  /usr/share/icons/hicolor/128x128/mimetypes/gnome-mime-application-x-smarttech-notebook.png
  /usr/share/icons/hicolor/16x16/apps/SMART_Board_Software.png
  /usr/share/icons/hicolor/16x16/apps/SMART_ControlPanel.png
  /usr/share/icons/hicolor/16x16/apps/SMART_Essentials_For_Educators.png
  /usr/share/icons/hicolor/16x16/apps/SMART_GallerySetup.png
  /usr/share/icons/hicolor/16x16/apps/SMART_Keyboard.png
  /usr/share/icons/hicolor/16x16/apps/SMART_LanguageChooser.png
  /usr/share/icons/hicolor/16x16/apps/SMART_Magnifier.png
  /usr/share/icons/hicolor/16x16/apps/SMART_Notebook.png
  /usr/share/icons/hicolor/16x16/apps/SMART_Orient.png
  /usr/share/icons/hicolor/16x16/apps/SMART_Pointer.png
  /usr/share/icons/hicolor/16x16/apps/SMART_ProductUpdate.png
  /usr/share/icons/hicolor/16x16/apps/SMART_ScreenCapture.png
  /usr/share/icons/hicolor/16x16/apps/SMART_ScreenShade.png
  /usr/share/icons/hicolor/16x16/apps/SMART_Spotlight.png
  /usr/share/icons/hicolor/16x16/apps/SMART_Tools.png
  /usr/share/icons/hicolor/16x16/mimetypes/application-x-smarttech-galleryitem.png
  /usr/share/icons/hicolor/16x16/mimetypes/application-x-smarttech-gallery.png
  /usr/share/icons/hicolor/16x16/mimetypes/application-x-smarttech-notebook.png
  /usr/share/icons/hicolor/16x16/mimetypes/gnome-mime-application-x-smarttech-galleryitem.png
  /usr/share/icons/hicolor/16x16/mimetypes/gnome-mime-application-x-smarttech-gallery.png
  /usr/share/icons/hicolor/16x16/mimetypes/gnome-mime-application-x-smarttech-notebook.png
  /usr/share/icons/hicolor/22x22/apps/SMART_Board_Software.png
  /usr/share/icons/hicolor/22x22/apps/SMART_ControlPanel.png
  /usr/share/icons/hicolor/22x22/apps/SMART_Essentials_For_Educators.png
  /usr/share/icons/hicolor/22x22/apps/SMART_GallerySetup.png
  /usr/share/icons/hicolor/22x22/apps/SMART_Keyboard.png
  /usr/share/icons/hicolor/22x22/apps/SMART_LanguageChooser.png
  /usr/share/icons/hicolor/22x22/apps/SMART_Magnifier.png
  /usr/share/icons/hicolor/22x22/apps/SMART_Notebook.png
  /usr/share/icons/hicolor/22x22/apps/SMART_Orient.png
  /usr/share/icons/hicolor/22x22/apps/SMART_Pointer.png
  /usr/share/icons/hicolor/22x22/apps/SMART_ProductUpdate.png
  /usr/share/icons/hicolor/22x22/apps/SMART_ScreenCapture.png
  /usr/share/icons/hicolor/22x22/apps/SMART_ScreenShade.png
  /usr/share/icons/hicolor/22x22/apps/SMART_Spotlight.png
  /usr/share/icons/hicolor/22x22/apps/SMART_Tools.png
  /usr/share/icons/hicolor/22x22/mimetypes/application-x-smarttech-galleryitem.png
  /usr/share/icons/hicolor/22x22/mimetypes/application-x-smarttech-gallery.png
  /usr/share/icons/hicolor/22x22/mimetypes/application-x-smarttech-notebook.png
  /usr/share/icons/hicolor/22x22/mimetypes/gnome-mime-application-x-smarttech-galleryitem.png
  /usr/share/icons/hicolor/22x22/mimetypes/gnome-mime-application-x-smarttech-gallery.png
  /usr/share/icons/hicolor/22x22/mimetypes/gnome-mime-application-x-smarttech-notebook.png
  /usr/share/icons/hicolor/32x32/apps/SMART_Board_Software.png
  /usr/share/icons/hicolor/32x32/apps/SMART_ControlPanel.png
  /usr/share/icons/hicolor/32x32/apps/SMART_Essentials_For_Educators.png
  /usr/share/icons/hicolor/32x32/apps/SMART_GallerySetup.png
  /usr/share/icons/hicolor/32x32/apps/SMART_Keyboard.png
  /usr/share/icons/hicolor/32x32/apps/SMART_LanguageChooser.png
  /usr/share/icons/hicolor/32x32/apps/SMART_Magnifier.png
  /usr/share/icons/hicolor/32x32/apps/SMART_Notebook.png
  /usr/share/icons/hicolor/32x32/apps/SMART_Orient.png
  /usr/share/icons/hicolor/32x32/apps/SMART_Pointer.png
  /usr/share/icons/hicolor/32x32/apps/SMART_ProductUpdate.png
  /usr/share/icons/hicolor/32x32/apps/SMART_ScreenCapture.png
  /usr/share/icons/hicolor/32x32/apps/SMART_ScreenShade.png
  /usr/share/icons/hicolor/32x32/apps/SMART_Spotlight.png
  /usr/share/icons/hicolor/32x32/apps/SMART_Tools.png
  /usr/share/icons/hicolor/32x32/mimetypes/application-x-smarttech-galleryitem.png
  /usr/share/icons/hicolor/32x32/mimetypes/application-x-smarttech-gallery.png
  /usr/share/icons/hicolor/32x32/mimetypes/application-x-smarttech-notebook.png
  /usr/share/icons/hicolor/32x32/mimetypes/gnome-mime-application-x-smarttech-galleryitem.png
  /usr/share/icons/hicolor/32x32/mimetypes/gnome-mime-application-x-smarttech-gallery.png
  /usr/share/icons/hicolor/32x32/mimetypes/gnome-mime-application-x-smarttech-notebook.png
  /usr/share/icons/hicolor/48x48/apps/SMART_Board_Software.png
  /usr/share/icons/hicolor/48x48/apps/SMART_ControlPanel.png
  /usr/share/icons/hicolor/48x48/apps/SMART_Essentials_For_Educators.png
  /usr/share/icons/hicolor/48x48/apps/SMART_GallerySetup.png
  /usr/share/icons/hicolor/48x48/apps/SMART_Keyboard.png
  /usr/share/icons/hicolor/48x48/apps/SMART_LanguageChooser.png
  /usr/share/icons/hicolor/48x48/apps/SMART_Magnifier.png
  /usr/share/icons/hicolor/48x48/apps/SMART_Notebook.png
  /usr/share/icons/hicolor/48x48/apps/SMART_Orient.png
  /usr/share/icons/hicolor/48x48/apps/SMART_Pointer.png
  /usr/share/icons/hicolor/48x48/apps/SMART_ProductUpdate.png
  /usr/share/icons/hicolor/48x48/apps/SMART_ScreenCapture.png
  /usr/share/icons/hicolor/48x48/apps/SMART_ScreenShade.png
  /usr/share/icons/hicolor/48x48/apps/SMART_Spotlight.png
  /usr/share/icons/hicolor/48x48/apps/SMART_Tools.png
  /usr/share/icons/hicolor/48x48/mimetypes/application-x-smarttech-galleryitem.png
  /usr/share/icons/hicolor/48x48/mimetypes/application-x-smarttech-gallery.png
  /usr/share/icons/hicolor/48x48/mimetypes/application-x-smarttech-notebook.png
  /usr/share/icons/hicolor/48x48/mimetypes/gnome-mime-application-x-smarttech-galleryitem.png
  /usr/share/icons/hicolor/48x48/mimetypes/gnome-mime-application-x-smarttech-gallery.png
  /usr/share/icons/hicolor/48x48/mimetypes/gnome-mime-application-x-smarttech-notebook.png
  /usr/share/icons/hicolor/scalable/apps/SMART_LanguageChooser.svg
  /usr/share/man/man1/smart-activation.1.gz
  /usr/share/man/man1/smart-common.1.gz
  /usr/share/man/man1/smart-gallerysetup.1.gz
  /usr/share/man/man1/smart-hwr.1.gz
  /usr/share/man/man1/smart-languagesetup.1.gz
  /usr/share/man/man1/smart-notebook.1.gz
  /usr/share/man/man1/smart-product-drivers.1.gz
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_Board_Software.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_ControlPanel.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_Essentials_For_Educators.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_GallerySetup.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_Keyboard.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_LanguageChooser.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_Magnifier.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_Notebook.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_Orient.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_Pointer.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_ProductUpdate.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_ScreenCapture.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_ScreenShade.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_Spotlight.png
  /usr/share/pixmaps/hicolor/128x128/apps/SMART_Tools.png
  /usr/share/pixmaps/hicolor/128x128/mimetypes/application-x-smarttech-galleryitem.png
  /usr/share/pixmaps/hicolor/128x128/mimetypes/application-x-smarttech-gallery.png
  /usr/share/pixmaps/hicolor/128x128/mimetypes/application-x-smarttech-notebook.png
  /usr/share/pixmaps/hicolor/128x128/mimetypes/gnome-mime-application-x-smarttech-galleryitem.png
  /usr/share/pixmaps/hicolor/128x128/mimetypes/gnome-mime-application-x-smarttech-gallery.png
  /usr/share/pixmaps/hicolor/128x128/mimetypes/gnome-mime-application-x-smarttech-notebook.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_Board_Software.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_ControlPanel.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_Essentials_For_Educators.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_GallerySetup.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_Keyboard.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_LanguageChooser.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_Magnifier.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_Notebook.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_Orient.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_Pointer.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_ProductUpdate.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_ScreenCapture.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_ScreenShade.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_Spotlight.png
  /usr/share/pixmaps/hicolor/16x16/apps/SMART_Tools.png
  /usr/share/pixmaps/hicolor/16x16/mimetypes/application-x-smarttech-galleryitem.png
  /usr/share/pixmaps/hicolor/16x16/mimetypes/application-x-smarttech-gallery.png
  /usr/share/pixmaps/hicolor/16x16/mimetypes/application-x-smarttech-notebook.png
  /usr/share/pixmaps/hicolor/16x16/mimetypes/gnome-mime-application-x-smarttech-galleryitem.png
  /usr/share/pixmaps/hicolor/16x16/mimetypes/gnome-mime-application-x-smarttech-gallery.png
  /usr/share/pixmaps/hicolor/16x16/mimetypes/gnome-mime-application-x-smarttech-notebook.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_Board_Software.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_ControlPanel.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_Essentials_For_Educators.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_GallerySetup.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_Keyboard.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_LanguageChooser.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_Magnifier.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_Notebook.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_Orient.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_Pointer.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_ProductUpdate.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_ScreenCapture.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_ScreenShade.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_Spotlight.png
  /usr/share/pixmaps/hicolor/22x22/apps/SMART_Tools.png
  /usr/share/pixmaps/hicolor/22x22/mimetypes/application-x-smarttech-galleryitem.png
  /usr/share/pixmaps/hicolor/22x22/mimetypes/application-x-smarttech-gallery.png
  /usr/share/pixmaps/hicolor/22x22/mimetypes/application-x-smarttech-notebook.png
  /usr/share/pixmaps/hicolor/22x22/mimetypes/gnome-mime-application-x-smarttech-galleryitem.png
  /usr/share/pixmaps/hicolor/22x22/mimetypes/gnome-mime-application-x-smarttech-gallery.png
  /usr/share/pixmaps/hicolor/22x22/mimetypes/gnome-mime-application-x-smarttech-notebook.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_Board_Software.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_ControlPanel.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_Essentials_For_Educators.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_GallerySetup.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_Keyboard.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_LanguageChooser.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_Magnifier.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_Notebook.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_Orient.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_Pointer.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_ProductUpdate.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_ScreenCapture.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_ScreenShade.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_Spotlight.png
  /usr/share/pixmaps/hicolor/32x32/apps/SMART_Tools.png
  /usr/share/pixmaps/hicolor/32x32/mimetypes/application-x-smarttech-galleryitem.png
  /usr/share/pixmaps/hicolor/32x32/mimetypes/application-x-smarttech-gallery.png
  /usr/share/pixmaps/hicolor/32x32/mimetypes/application-x-smarttech-notebook.png
  /usr/share/pixmaps/hicolor/32x32/mimetypes/gnome-mime-application-x-smarttech-galleryitem.png
  /usr/share/pixmaps/hicolor/32x32/mimetypes/gnome-mime-application-x-smarttech-gallery.png
  /usr/share/pixmaps/hicolor/32x32/mimetypes/gnome-mime-application-x-smarttech-notebook.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_Board_Software.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_ControlPanel.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_Essentials_For_Educators.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_GallerySetup.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_Keyboard.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_LanguageChooser.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_Magnifier.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_Notebook.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_Orient.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_Pointer.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_ProductUpdate.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_ScreenCapture.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_ScreenShade.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_Spotlight.png
  /usr/share/pixmaps/hicolor/48x48/apps/SMART_Tools.png
  /usr/share/pixmaps/hicolor/48x48/mimetypes/application-x-smarttech-galleryitem.png
  /usr/share/pixmaps/hicolor/48x48/mimetypes/application-x-smarttech-gallery.png
  /usr/share/pixmaps/hicolor/48x48/mimetypes/application-x-smarttech-notebook.png
  /usr/share/pixmaps/hicolor/48x48/mimetypes/gnome-mime-application-x-smarttech-galleryitem.png
  /usr/share/pixmaps/hicolor/48x48/mimetypes/gnome-mime-application-x-smarttech-gallery.png
  /usr/share/pixmaps/hicolor/48x48/mimetypes/gnome-mime-application-x-smarttech-notebook.png
  /usr/share/pixmaps/hicolor/scalable/apps/SMART_LanguageChooser.svg
'

case "${command}" in
    configure)
        upstream_dir=$1

        for f in "$smart_technologies_dir" ${smartboard_links}; do
            mkdir -p "$(dirname "$f")"
            ln -s -f -T "${upstream_dir}/smartboard${f}" "$f"
        done
        ;;
    unconfigure)
        rm -f "$smart_technologies_dir" ${smartboard_links}
        ;;
    unpack)
        upstream_pack=$1
        upstream_dir=$2
        tar --no-same-owner -z -x -f "${upstream_pack}" -C "${upstream_dir}"
        for deb in $debfiles; do
            dpkg -x "${upstream_dir}/${deb}" "${upstream_dir}/smartboard"
            rm -f "${upstream_dir}/${deb}"
        done

        (
            cd "${upstream_dir}/smartboard${smart_technologies_dir}/common/lib"
            for lib in ../lib.common/*; do
                ln -fns "$lib" "$(basename "$lib")"
            done
            cd "${upstream_dir}/smartboard${smart_technologies_dir}/common/nb/lib"
            for lib in ../../lib.common/*; do
                ln -fns "$lib" "$(basename "$lib")"
            done
        )
        ;;
    *)
        ;;
esac
